<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="assets/css/pages/tela-cadastro-fotografo/index.css">

</head>

<body>
    <div class="modal-overlay" id="cadastroModal">
        <section class="section-cadastro-fotografo">
            <button class="section-cadastro-fotografo__modal-close" id="closeModal">&times;</button>

            <div class="section-cadastro-fotografo__div-title">
                <h1>Crie uma conta</h1>
                <p>Faça o cadastro e, tenha uma plataforma inteira de visibilidade</p>
            </div>

            <div class="section-cadastro__div-input">
                <form action="cadastro.php" method="POST">
                    <!-- E-mail -->
                    <div class="div-input__e-mail">
                        <label for="input-email">E-mail</label>
                        <input type="email" id="input-email" name="email" placeholder="E-mail" required>
                        <hr>
                    </div>

                    <!-- Sobre você -->
                    <div class="div-input__sobre-voce">
                        <label for="input-empresa">Nome da empresa</label>
                        <input type="text" id="input-empresa" name="empresa" placeholder="Nome da empresa" required>

                        <label for="input-nome">Nome completo</label>
                        <input type="text" id="input-nome" name="nome" placeholder="Nome completo" required>

                        <label for="input-telefone">Telefone</label>
                        <input type="tel" id="input-telefone" name="telefone" placeholder="Telefone" required>
                        <hr>
                    </div>

                    <!-- Senha -->
                    <div class="div-input__senha">
                        <label for="input-senha">Senha</label>
                        <input type="password" id="input-senha" name="senha" placeholder="Senha" required>
                        <hr>
                    </div>

                    <div class="div-input__imagem-local">
                        <label for="input-imagem">Adicione seu local de trabalho <strong>(Opcional)</strong></label>

                        <!-- Input escondido -->
                        <input type="file" id="input-imagem" accept="image/*" style="display: none;">

                        <!-- Área clicável -->
                        <div id="preview" class="imagem-local__upload-box"
                            onclick="document.getElementById('input-imagem').click()" role="button" tabindex="0"
                            aria-label="Adicionar imagem do local de trabalho">
                            <img src="assets/img/page/tela-cadastro-fotografo/photo_camera_24dp_000000_FILL0_wght400_GRAD0_opsz24.svg"
                                alt="ícone câmera" id="icone-camera" style="width: 36px; opacity: 0.7;">
                            <p>
                                Adicione uma foto do seu local de trabalho.<br>
                                <span>Opcional, mas altamente recomendado. Mostre aos clientes o que você faz.</span>
                            </p>
                        </div>
                    </div>

                    <!-- Localização completa -->
                    <div class="div-input__localizacao">
                        <label for="input-cep">CEP</label>
                        <div style="position: relative;">
                            <input type="text" id="input-cep" name="cep" placeholder="Digite o CEP" maxlength="10">
                            <span
                                style="position: absolute; top: 50%; right: 12px; transform: translateY(-50%); cursor: pointer;">
                                <img src="assets/img/page/tela-cadastro-fotografo/search_24dp_000000_FILL0_wght400_GRAD0_opsz24.svg"
                                    alt="Buscar" style="width: 18px; opacity: 0.6;">
                            </span>
                        </div>

                        <input type="text" id="input-endereco" name="endereco" placeholder="Rua" readonly>
                        <input type="text" id="input-numero" name="numero" placeholder="Número do endereço">
                        <input type="text" id="input-bairro" name="bairro" placeholder="Bairro" readonly>
                        <input type="text" id="input-cidade" name="cidade" placeholder="Cidade" readonly>
                        <input type="text" id="input-estado" name="estado" placeholder="Estado" readonly>
                        <input type="text" id="input-complemento" name="complemento" placeholder="Complemento">
                    </div>

                    <!-- Tipo de ensaio -->
                    <div class="div-input__tipo-ensaio">
                        <label for="input-ensaio">Seu tipo de ensaio</label>
                        <select id="input-ensaio" name="tipo_ensaio" required>
                            <option value="" disabled selected>Escolha</option>
                            <option value="casamento">Casamento</option>
                            <option value="gestante">Gestante</option>
                            <option value="infantil">Infantil</option>
                            <option value="família">Família</option>
                            <option value="ensaio-externo">Ensaio Externo</option>
                            <option value="studio">Estúdio</option>
                            <option value="outro">Outro</option>
                        </select>
                    </div>


                    <div class="horarios-container">
                        <h3>Horários de funcionamento</h3>

                        <!-- Segunda -->
                        <div class="dia" data-dia="Segunda" data-horario="09:00-18:00">
                            <span class="dia-nome">Segunda</span>
                            <span class="dia-horario">09:00-18:00</span>
                            <div class="acoes">
                                <label class="switch">
                                    <input type="checkbox" name="segunda_status" checked>
                                    <span class="slider"></span>
                                </label>
                                <button type="button" class="btn-config">
                                    <img src="assets/img/page/tela-cadastro-fotografo/keyboard_arrow_right_24dp_000000_FILL0_wght400_GRAD0_opsz24.svg"
                                        alt="">
                                </button>
                            </div>
                            <input type="hidden" name="segunda_horario" value="09:00-18:00">
                        </div>

                        <!-- Terça -->
                        <div class="dia" data-dia="Terça" data-horario="09:00-18:00">
                            <span class="dia-nome">Terça</span>
                            <span class="dia-horario">09:00-18:00</span>
                            <div class="acoes">
                                <label class="switch">
                                    <input type="checkbox" name="terca_status" checked>
                                    <span class="slider"></span>
                                </label>
                                <button type="button" class="btn-config">
                                    <img src="assets/img/page/tela-cadastro-fotografo/keyboard_arrow_right_24dp_000000_FILL0_wght400_GRAD0_opsz24.svg"
                                        alt="">
                                </button>
                            </div>
                            <input type="hidden" name="terca_horario" value="09:00-18:00">
                        </div>

                        <!-- Quarta -->
                        <div class="dia" data-dia="Quarta" data-horario="09:00-18:00">
                            <span class="dia-nome">Quarta</span>
                            <span class="dia-horario">09:00-18:00</span>
                            <div class="acoes">
                                <label class="switch">
                                    <input type="checkbox" name="quarta_status" checked>
                                    <span class="slider"></span>
                                </label>
                                <button type="button" class="btn-config">
                                    <img src="assets/img/page/tela-cadastro-fotografo/keyboard_arrow_right_24dp_000000_FILL0_wght400_GRAD0_opsz24.svg"
                                        alt="">
                                </button>
                            </div>
                            <input type="hidden" name="quarta_horario" value="09:00-18:00">
                        </div>

                        <!-- Quinta -->
                        <div class="dia" data-dia="Quinta" data-horario="09:00-18:00">
                            <span class="dia-nome">Quinta</span>
                            <span class="dia-horario">09:00-18:00</span>
                            <div class="acoes">
                                <label class="switch">
                                    <input type="checkbox" name="quinta_status" checked>
                                    <span class="slider"></span>
                                </label>
                                <button type="button" class="btn-config">
                                    <img src="assets/img/page/tela-cadastro-fotografo/keyboard_arrow_right_24dp_000000_FILL0_wght400_GRAD0_opsz24.svg"
                                        alt="">
                                </button>
                            </div>
                            <input type="hidden" name="quinta_horario" value="09:00-18:00">
                        </div>

                        <!-- Sexta -->
                        <div class="dia" data-dia="Sexta" data-horario="09:00-18:00">
                            <span class="dia-nome">Sexta</span>
                            <span class="dia-horario">09:00-18:00</span>
                            <div class="acoes">
                                <label class="switch">
                                    <input type="checkbox" name="sexta_status" checked>
                                    <span class="slider"></span>
                                </label>
                                <button type="button" class="btn-config">
                                    <img src="assets/img/page/tela-cadastro-fotografo/keyboard_arrow_right_24dp_000000_FILL0_wght400_GRAD0_opsz24.svg"
                                        alt="">
                                </button>
                            </div>
                            <input type="hidden" name="sexta_horario" value="09:00-18:00">
                        </div>

                        <!-- Sábado -->
                        <div class="dia" data-dia="Sábado" data-horario="Fechado">
                            <span class="dia-nome">Sábado</span>
                            <span class="dia-horario">Fechado</span>
                            <div class="acoes">
                                <label class="switch">
                                    <input type="checkbox" name="sabado_status">
                                    <span class="slider"></span>
                                </label>
                                <button type="button" class="btn-config disabled">
                                    <img src="assets/img/page/tela-cadastro-fotografo/keyboard_arrow_right_24dp_000000_FILL0_wght400_GRAD0_opsz24.svg"
                                        alt="">
                                </button>
                            </div>
                            <input type="hidden" name="sabado_horario" value="Fechado">
                        </div>

                        <!-- Domingo -->
                        <div class="dia" data-dia="Domingo" data-horario="Fechado">
                            <span class="dia-nome">Domingo</span>
                            <span class="dia-horario">Fechado</span>
                            <div class="acoes">
                                <label class="switch">
                                    <input type="checkbox" name="domingo_status">
                                    <span class="slider"></span>
                                </label>
                                <button type="button" class="btn-config disabled">
                                    <img src="assets/img/page/tela-cadastro-fotografo/keyboard_arrow_right_24dp_000000_FILL0_wght400_GRAD0_opsz24.svg"
                                        alt="">
                                </button>
                            </div>
                            <input type="hidden" name="domingo_horario" value="Fechado">
                        </div>
                    </div>

                    <!-- Modal de configuração do horário -->
                    <div id="modal-horario" class="modal-overlay" style="display:none;">
                        <div class="section-cadastro-fotografo">
                            <button class="section-cadastro-fotografo__modal-close">&times;</button>
                            <div class="section-cadastro-fotografo__div-title">
                                <h3>Configurar Horário</h3>
                                <p id="modal-dia-nome"></p>
                            </div>
                            <div style="padding: 20px;">
                                <label>Hora de início</label>
                                <input type="time" id="hora-inicio">
                                <label>Hora de fim</label>
                                <input type="time" id="hora-fim">
                                <button id="salvar-horario" style="margin-top:10px;">Salvar</button>
                            </div>
                        </div>
                    </div>

                    <div class="div-input__adicionar-ensaio">
                        <!-- Nome do Ensaio -->
                        <div class="adicionar-ensaio__nome-ensaio">
                            <label for="input-nome-ensaio">Nome do Ensaio</label>
                            <input type="text" id="input-nome-ensaio" name="nome_ensaio"
                                placeholder="Digite o nome do ensaio" required>
                        </div>

                        <!-- Duração -->
                        <div class="adicionar-ensaio__duracao">
                            <label for="select-horas">Duração</label>
                            <div class="duracao-container">
                                <!-- Horas -->
                                <select id="select-horas" name="horas" required>
                                    <option value="0">0 h</option>
                                    <option value="1">1 h</option>
                                    <option value="2">2 h</option>
                                    <option value="3">3 h</option>
                                    <option value="4">4 h</option>
                                    <option value="5">5 h</option>
                                    <option value="6">6 h</option>
                                    <option value="7">7 h</option>
                                    <option value="8">8 h</option>
                                    <option value="9">9 h</option>
                                    <option value="10">10 h</option>
                                    <option value="11">11 h</option>
                                    <option value="12">12 h</option>
                                </select>

                                <span>:</span>

                                <!-- Minutos -->
                                <select id="select-minutos" name="minutos" required>
                                    <option value="0">00 min</option>
                                    <option value="5">05 min</option>
                                    <option value="10">10 min</option>
                                    <option value="15">15 min</option>
                                    <option value="20">20 min</option>
                                    <option value="25">25 min</option>
                                    <option value="30">30 min</option>
                                    <option value="35">35 min</option>
                                    <option value="40">40 min</option>
                                    <option value="45">45 min</option>
                                    <option value="50">50 min</option>
                                    <option value="55">55 min</option>
                                </select>
                            </div>
                        </div>


                        <!-- Preço -->
                        <div class="adicionar-ensaio__preco">
                            <label for="input-preco">Preço</label>
                            <div class="preco-wrapper">
                                <span class="preco-simbolo">R$</span>
                                <input type="text" id="input-preco" name="preco" placeholder="0,00" inputmode="numeric"
                                    required>
                            </div>
                        </div>

                    </div>







                    <div class="section-cadastro__div-button">
                        <input type="submit" value="Cadastrar-se">
                        <p>Já tenho uma conta</p>
                    </div>
                </form>
            </div>
        </section>
    </div>

    <script>
        const inputImagem = document.getElementById('input-imagem');
        const preview = document.getElementById('preview');

        // salva o HTML inicial do preview para restaurar depois
        const initialPreviewHTML = preview.innerHTML;

        // abrir filepicker por teclado também
        preview.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                inputImagem.click();
            }
        });

        // quando escolher arquivo
        inputImagem.addEventListener('change', function () {
            if (this.files && this.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    // insere botão X e a imagem preview
                    preview.innerHTML = `
          <button type="button" class="remove-btn" aria-label="Remover imagem">&times;</button>
          <img class="preview-img" src="${e.target.result}" alt="Preview da imagem">
        `;

                    // evento para o botão X recém-criado
                    const btn = preview.querySelector('.remove-btn');
                    btn.addEventListener('click', removerImagem);
                };
                reader.readAsDataURL(this.files[0]);
            }
        });

        function removerImagem(event) {
            event.stopPropagation(); // não dispara clique no preview
            // limpa input de arquivo
            inputImagem.value = '';
            // restaura o HTML inicial (ícone + texto)
            preview.innerHTML = initialPreviewHTML;

            // re-reattach do listener de teclado porque innerHTML foi substituído
            preview.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    inputImagem.click();
                }
            });
        }
        document.getElementById('input-cep').addEventListener('blur', function () {
            const cep = this.value.replace(/\D/g, ''); // remove qualquer caracter que não seja número
            if (cep.length !== 8) {
                alert('CEP inválido! Um CEP tem 8 numeros, tente apenas digitar os 8 numeros sem caracteres.');
                return;
            }

            // Chamada à API ViaCEP
            fetch(`https://viacep.com.br/ws/${cep}/json/`)
                .then(response => response.json())
                .then(data => {
                    if (data.erro) {
                        alert('CEP não encontrado!');
                        return;
                    }

                    document.getElementById('input-endereco').value = data.logradouro || '';
                    document.getElementById('input-bairro').value = data.bairro || '';
                    document.getElementById('input-cidade').value = data.localidade || '';
                    document.getElementById('input-estado').value = data.uf || '';
                })
                .catch(error => {
                    console.error('Erro ao buscar CEP:', error);
                });
        });

        const modal = document.getElementById('modal-horario');
        const closeBtnHorario = modal.querySelector('.section-cadastro-fotografo__modal-close');
        const modalDiaNome = document.getElementById('modal-dia-nome');
        const horaInicioInput = document.getElementById('hora-inicio');
        const horaFimInput = document.getElementById('hora-fim');
        let diaAtual = null;

        closeBtnHorario.addEventListener('click', () => {
            modal.style.display = 'none';
        });

        // Botões de configuração
        document.querySelectorAll('.dia .btn-config').forEach(btn => {
            btn.addEventListener('click', () => {
                const dia = btn.closest('.dia');
                const checkbox = dia.querySelector('input[type="checkbox"]');

                // Só abre o modal se o switch estiver ativo (não fechado)
                if (!checkbox.checked) return;

                diaAtual = dia;
                modalDiaNome.textContent = dia.dataset.dia;

                let horario = dia.dataset.horario;
                if (horario !== 'Fechado') {
                    let partes = horario.split('-');
                    horaInicioInput.value = partes[0];
                    horaFimInput.value = partes[1];
                } else {
                    horaInicioInput.value = '09:00';
                    horaFimInput.value = '18:00';
                }

                modal.style.display = 'flex';
            });
        });

        // Fechar modal
        document.querySelector('.section-cadastro-fotografo__modal-close').addEventListener('click', () => {
            modal.style.display = 'none';
        });

        // Salvar horário
        document.getElementById('salvar-horario').addEventListener('click', () => {
            const novoHorario = `${horaInicioInput.value}-${horaFimInput.value}`;

            diaAtual.dataset.horario = novoHorario;

            const statusSpan = diaAtual.querySelector('.dia-horario');
            const checkbox = diaAtual.querySelector('input[type="checkbox"]');
            const hiddenInput = diaAtual.querySelector('input[type="hidden"]');

            statusSpan.textContent = checkbox.checked ? novoHorario : 'Fechado';

            // 🔑 Atualiza o input hidden que vai pro backend
            if (hiddenInput) {
                hiddenInput.value = checkbox.checked ? novoHorario : 'Fechado';
            }

            modal.style.display = 'none';
        });


        // Atualiza status quando o switch muda
        document.querySelectorAll('.dia input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                const dia = checkbox.closest('.dia');
                const statusSpan = dia.querySelector('.dia-horario');
                const btnConfig = dia.querySelector('.btn-config');
                const hiddenInput = dia.querySelector('input[type="hidden"]');

                if (checkbox.checked) {
                    const horario = dia.dataset.horario !== 'Fechado' ? dia.dataset.horario : '09:00-18:00';
                    statusSpan.textContent = horario;
                    if (hiddenInput) hiddenInput.value = horario;
                    btnConfig.classList.remove('disabled');
                } else {
                    statusSpan.textContent = 'Fechado';
                    if (hiddenInput) hiddenInput.value = 'Fechado';
                    btnConfig.classList.add('disabled');
                }
            });
        });
        const inputPreco = document.getElementById("input-preco");

        inputPreco.addEventListener("input", (e) => {
            let value = e.target.value;

            // Remove tudo que não for número
            value = value.replace(/\D/g, "");

            // Converte para centavos
            value = (parseInt(value, 10) / 100).toFixed(2);

            // Formata em estilo brasileiro (R$ 1.234,56)
            value = new Intl.NumberFormat("pt-BR", {
                style: "currency",
                currency: "BRL"
            }).format(value);

            // Remove o R$ porque já temos o <span>
            e.target.value = value.replace("R$", "").trim();
        });




    </script>
    <script src="https://unpkg.com/imask"></script>





</body>

</html>