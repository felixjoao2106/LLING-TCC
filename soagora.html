<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="assets/css/pages/modal-contrate/index.css">

</head>

<body>
    <div class="modal-overlay">
        <section class="modal-overlay__section-tela-contrate">
            <h2>Escolher data</h2>
            <form id="form-contrate" action="#">

                <div class="section-tela-contrate__div-wrapper">
                    <div class="div-wrapper__next-left">
                        <div class="next-left__icon">❮</div>
                    </div>
                    <section class="div-wrapper__dias-disponiveis">

                    </section>
                    <input id="input-data-selecionada" type="date" disabled hidden>

                    <div class="div-wrapper__next-rigth">
                        <div class="next-rigth__icon">❯</div>
                    </div>
                </div>
                <p>Setembro 2025</p>
                <hr>
                <div class="section-tela-contrate__container-horario">
                    <div class="container-horario__manha manha--ativ">
                        <p>Manhã</p>
                    </div>
                    <div class="container-horario__tarde tarde--ativo">
                        <p>Tarde</p>
                    </div>
                    <div class="container-horario__noite noite--ativ">
                        <p>Noite</p>
                    </div>
                </div>
                <div class="section-tela-contrate__horarios">
                    <div class="horarios__next-left">
                        <div class="next-left__icon">❮</div>
                    </div>
                    <div class="horarios__wrapper">
                        <div class="wrapper__horario">
                            <p>09:00</p>
                        </div>
                    </div>
                    <div class="horarios__next-rigth">
                        <div class="next-rigth__icon">❯</div>
                    </div>
                    <input type="time" disabled hidden>
                </div>
                <hr>
                <div class="section-tela-contrate__info">
                    <div class="info__container">
                        <div class="info__container__titulo-periodo">
                            <h3>Baby born</h3>
                            <p>Periodo: 40min</p>
                        </div>
                        <div class="info__container__preco">
                            <h2>R$200</h2>
                        </div>
                    </div>
                    <hr>
                    <div class="info__funcionario">
                        <p>Funcionarios: Andre</p>
                        <button type="button">Alterar</button>
                    </div>
                </div>
                <hr>
                <div class="section-tela-contrate__confirmar">
                    <div class="confirmar__title-periodo">
                        <h2>Baby born</h2>
                        <p>Periodo: 40min</p>
                    </div>
                    <div class="confirmar__preco-btnconfirmar">
                        <input type="submit" value="Confirmar"></input>
                        <p>Tota: R$200</p>
                    </div>

                </div>
            </form>
        </section>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const diasContainer = document.querySelector('.div-wrapper__dias-disponiveis');
            const leftArrow = document.querySelector('.next-left__icon');
            const rightArrow = document.querySelector('.next-rigth__icon');
            const inputHidden = document.getElementById('input-data-selecionada');

            const diasPorPagina = 6;

            // Se quiser “hoje” como início dinâmico:
            const hoje = new Date();
            // Opcional: zerar hora/minuto/segundo
            hoje.setHours(0, 0, 0, 0);

            let paginaAtual = 0;
            let diasGerados = []; // { data: Date, iso: string, dia: num, mes: string, diaSemana: string }

            function formatarIso(d) {
                return d.toISOString().split('T')[0];
            }
            function nomeMes(d) {
                return new Intl.DateTimeFormat('pt-BR', { month: 'long' }).format(d);
            }
            function nomeDiaSemana(d) {
                return new Intl.DateTimeFormat('pt-BR', { weekday: 'long' }).format(d);
            }

            function gerarDias(qtd) {
                // gera qtd dias adicionais a partir do que já existe
                let inicioIndex = diasGerados.length;
                for (let i = inicioIndex; i < inicioIndex + qtd; i++) {
                    const d = new Date(hoje);
                    d.setDate(d.getDate() + i);
                    diasGerados.push({
                        data: d,
                        iso: formatarIso(d),
                        dia: d.getDate(),
                        mes: nomeMes(d),
                        diaSemana: nomeDiaSemana(d)
                    });
                }
            }

            function renderizarDias(pagina) {
                diasContainer.innerHTML = '';
                const inicio = pagina * diasPorPagina;
                const fim = inicio + diasPorPagina;
                const subset = diasGerados.slice(inicio, fim);

                subset.forEach(obj => {
                    const card = document.createElement('div');
                    card.classList.add('dias-disponiveis__container-dia');
                    card.dataset.iso = obj.iso;
                    card.innerHTML = `
            <div class="container-dia__status"></div>
            <p>${obj.mes}</p>
            <p>${obj.dia}</p>
            <p>${obj.diaSemana}</p>
          `;
                    card.addEventListener('click', () => {
                        // remover classe selected de todos
                        diasContainer.querySelectorAll('.dias-disponiveis__container-dia')
                            .forEach(el => el.classList.remove('selected'));
                        // ativar o clicado
                        card.classList.add('selected');
                        // salvar no input hidden
                        inputHidden.value = obj.iso;
                    });

                    diasContainer.appendChild(card);
                });

                // se quiser manter o input no DOM
                diasContainer.appendChild(inputHidden);
            }

            leftArrow.addEventListener('click', () => {
                if (paginaAtual > 0) {
                    paginaAtual--;
                    renderizarDias(paginaAtual);
                }
            });
            rightArrow.addEventListener('click', () => {
                const totalPaginas = Math.ceil(diasGerados.length / diasPorPagina);
                if (paginaAtual + 1 >= totalPaginas) {
                    // gerar mais dias para próximas páginas
                    gerarDias(diasPorPagina);
                }
                paginaAtual++;
                renderizarDias(paginaAtual);
            });

            // inicialização
            gerarDias(diasPorPagina * 2); // gera 2 páginas de início
            renderizarDias(paginaAtual);

            // opcional: definir valor inicial (selecionar primeiro dia)
            const primeiro = diasContainer.querySelector('.dias-disponiveis__container-dia');
            if (primeiro) {
                primeiro.click();
            }

            // tratamento do submit
            const form = document.getElementById('form-contrate');
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                console.log('Data selecionada:', inputHidden.value);
                // enviar, validar, etc.
            });
        });
















        document.addEventListener('DOMContentLoaded', async () => {
            // Simulação de dados do fotógrafo vindos do backend
            const fotografo = {
                horarios_funcionamento: {
                    Segunda: { status: true, horario: "09:00-18:00" },
                    Terça: { status: true, horario: "09:00-18:00" },
                    Quarta: { status: true, horario: "09:00-18:00" },
                    Quinta: { status: true, horario: "09:00-18:00" },
                    Sexta: { status: true, horario: "09:00-18:00" },
                    Sábado: { status: false, horario: "Fechado" },
                    Domingo: { status: false, horario: "Fechado" }
                },
                ensaios: [
                    { nome: "Baby born", duracao: 40, preco: 200 }
                ]
            };

            // Ensaio selecionado
            const ensaioSelecionado = fotografo.ensaios.find(e => e.nome === "Baby born");
            const duracao = ensaioSelecionado.duracao; // minutos

            // Funções auxiliares
            const toMinutes = h => {
                const [hh, mm] = h.split(":").map(Number);
                return hh * 60 + mm;
            };

            const toHour = min => {
                const hh = String(Math.floor(min / 60)).padStart(2, "0");
                const mm = String(min % 60).padStart(2, "0");
                return `${hh}:${mm}`;
            };

            // Gera horários com base na duração
            function gerarHorarios(dia, duracao) {
                const info = fotografo.horarios_funcionamento[dia];
                if (!info.status || info.horario === "Fechado") return [];

                const [inicio, fim] = info.horario.split("-");
                let horaInicio = toMinutes(inicio);
                const horaFim = toMinutes(fim);
                const horarios = [];

                while (horaInicio + duracao <= horaFim) {
                    const h = toHour(horaInicio);
                    let periodo = "";
                    if (horaInicio < 12 * 60) periodo = "manha";
                    else if (horaInicio < 18 * 60) periodo = "tarde";
                    else periodo = "noite";

                    horarios.push({ hora: h, periodo });
                    horaInicio += duracao;
                }

                return horarios;
            }

            // Exemplo: gerar horários para quarta-feira
            const hoje = "Quarta";
            const horarios = gerarHorarios(hoje, duracao);

            const wrapperHorarios = document.querySelector('.horarios__wrapper');

            // Renderiza todos os horários de uma vez
            horarios.forEach(h => {
                const div = document.createElement('div');
                div.classList.add('wrapper__horario');
                div.dataset.periodo = h.periodo; // ex: manha, tarde, noite
                div.innerHTML = `<p>${h.hora}</p>`;
                wrapperHorarios.appendChild(div);
            });

            // --- FILTRO DE PERÍODOS ---
            const btnManha = document.querySelector('.container-horario__manha');
            const btnTarde = document.querySelector('.container-horario__tarde');
            const btnNoite = document.querySelector('.container-horario__noite');

            function mostrarPeriodo(periodo) {
                wrapperHorarios.querySelectorAll('.wrapper__horario').forEach(div => {
                    div.style.display = div.dataset.periodo === periodo ? 'flex' : 'none';
                });

                // alterna estilo visual dos botões
                [btnManha, btnTarde, btnNoite].forEach(btn => btn.classList.remove('ativo'));
                if (periodo === 'manha') btnManha.classList.add('ativo');
                if (periodo === 'tarde') btnTarde.classList.add('ativo');
                if (periodo === 'noite') btnNoite.classList.add('ativo');
            }

            // eventos de clique
            btnManha.addEventListener('click', () => mostrarPeriodo('manha'));
            btnTarde.addEventListener('click', () => mostrarPeriodo('tarde'));
            btnNoite.addEventListener('click', () => mostrarPeriodo('noite'));

            // Mostra todos no início
            wrapperHorarios.querySelectorAll('.wrapper__horario').forEach(div => div.style.display = 'flex');

            // Marcar botão padrão (todos)
            [btnManha, btnTarde, btnNoite].forEach(btn => btn.classList.remove('ativo'));
            btnManha.classList.add('ativo');

            // --- NAVEGAÇÃO DO CARROSSEL ---
            const leftArrow = document.querySelector('.horarios__next-left');
            const rightArrow = document.querySelector('.horarios__next-rigth');

            let scrollPosition = 0;
            const scrollStep = 200; // pixels a mover por clique

            leftArrow.addEventListener('click', () => {
                wrapperHorarios.scrollBy({ left: -scrollStep, behavior: 'smooth' });
            });

            rightArrow.addEventListener('click', () => {
                wrapperHorarios.scrollBy({ left: scrollStep, behavior: 'smooth' });
            });
        });
    </script>
</body>

</html>